<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
<TITLE> </TITLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#c8c8c8" LINK="#000000" VLINK="#c800c8" BACKGROUND="img/bg.jpg">
<DIV ALIGN="center">
<FONT SIZE="6" COLOR="#ffff00"><B>技術情報</B></FONT></DIV>
<br><br>
【画像用プラグイン（ＳＰＩ等）について】<br>
<br>
NScripterでは、ＳＰＩの仕様のうち、次の部分に限定して使用しています。<br>
<br>
１．ＳＰＩ（実体はＤＬＬ）は、defファイルを付けてコンパイルされている。<br>
<br>
２．次の関数の機能を実装し、エキスポートしている。<br>
<br>
・画像展開ＳＰＩの場合<br>
<br>
int PASCAL GetPicture (<br>
　　　　LPSTR buf,long len,unsigned int flag,<br>
　　　　HANDLE *pHBInfo,HANDLE *pHBm,<br>
　　　　FARPROC lpPrgressCallback,long lData<br>
);<br>
<br>
呼び出すときにはこう呼ばれます。<br>
<br>
LPBITMAPINFO lpi;<br>
LPSTR lpb;<br>
char *filename;<br>
GetPicture (filename,0,0,&bi,&bm,NULL,0);<br>
<br>
・アーカイブ展開ＳＰＩの場合<br>
<br>
typedef struct {<br>
　　　　unsigned char method[8];<br>
　　　　unsigned long position;<br>
　　　　unsigned long compsize;<br>
　　　　unsigned long filesize;<br>
　　　　time_t timestamp;<br>
　　　　char path[200];<br>
　　　　char filename[200];<br>
　　　　unsigned long crc;<br>
} fileInfo;<br>
<br>
int PASCAL GetFile (<br>
　　　　LPSTR src,long len,LPSTR dest,unsigned int flag,<br>
　　　　FARPROC prgressCallback,long lData<br>
);<br>
<br>
int PASCAL GetFileInfo (<br>
　　　　LPSTR buf,long len,LPSTR filename,<br>
　　　　unsigned int flag,fileInfo *lpInfo<br>
);<br>
<br>
呼び出す時はこう呼ばれます。<br>
<br>
char *arcfilename;<br>
char *filename;<br>
char *write_dir;<br>
fileinfo fi;<br>
<br>
GetFileInfo (arcfilename,0,filename,0x80,&fi);<br>
GetFile	(arcfilename,fi.position,write_dir,0,NULL,0);<br>
<br>
ここで、GetFileが読み込むのも書き込むのもファイルである事にご注意ください。<br>
一応、これはSPIの標準機能なのですが、ひょっとして、To Fileな書き込みが
不可能なSPIもあるかもしれません。そういうＳＰＩが多いようでしたら、
対策を考えます。<br>
アーカイブ機能がうまく行かないＳＰＩもあるようなので、そういうのがあったら、
出来れば詳しく調べて改善したいので、情報を寄せていただけるとありがたいです。<br>
<br>
<br>
【WAV,MIDファイル用プラグインについて】<br>
単純に、一時ファイルを書きだしているだけです。<br>
int PASCAL expand (char *infilename,char *outfilename);<br>
infilenameで表されるファイルを展開して、outfilenameに書き出します。<br>
<br>

</BODY>
</HTML>
